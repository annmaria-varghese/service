<!DOCTYPE html>
<html>
<head>
    <title>Ingredient & Recipe Manager</title>
    <style>
        body { font-family: Arial; margin: 40px; background: #f8f8f8; }
        h1 { color: #444; }
        form { margin-bottom: 20px; }
        table { width: 100%; border-collapse: collapse; }
        th, td { border: 1px solid #ddd; padding: 10px; text-align: left; }
        th { background: #eee; }
        input[type=text], textarea { width: 300px; padding: 5px; }
        button { padding: 6px 10px; margin-left: 5px; cursor: pointer; }
        button:hover { background-color: #ccc; }
    </style>
</head>
<body>

<h1>Ingredient & Recipe Manager</h1>

<h2>Add Ingredient</h2>
<form id="ingredientForm">
    <input type="text" id="ingredientName" placeholder="Ingredient Name" required>
    <input type="text" id="ingredientQty" placeholder="Quantity" required>
    <button type="submit">Add Ingredient</button>
</form>

<h3>All Ingredients</h3>
<table id="ingredientTable">
    <tr><th>ID</th><th>Name</th><th>Quantity</th></tr>
</table>

<hr>

<h2>Add Recipe</h2>
<form id="recipeForm">
    <input type="text" id="recipeName" placeholder="Recipe Name" required><br><br>
    <textarea id="recipeInstructions" placeholder="Instructions" rows="4" cols="50"></textarea><br><br>
    <button type="submit">Add Recipe</button>
</form>

<h3>All Recipes</h3>
<table id="recipeTable">
    <tr><th>ID</th><th>Name</th><th>Instructions</th></tr>
</table>

<script>
    // Full URLs to Dockerized APIs
    const ING_URL = "http://127.0.0.1:5000/ingredients";
    const REC_URL = "http://127.0.0.1:5001/recipes";

    // Load Ingredients
    async function loadIngredients() {
        const res = await fetch(ING_URL);
        const data = await res.json();
        const table = document.getElementById("ingredientTable");
        table.innerHTML = "<tr><th>ID</th><th>Name</th><th>Quantity</th></tr>";
        data.forEach((i, idx) => {
            table.innerHTML += `<tr><td>${idx+1}</td><td>${i.name}</td><td>${i.quantity}</td></tr>`;
        });
    }

    // Load Recipes
    async function loadRecipes() {
        const res = await fetch(REC_URL);
        const data = await res.json();
        const table = document.getElementById("recipeTable");
        table.innerHTML = "<tr><th>ID</th><th>Name</th><th>Instructions</th></tr>";
        data.forEach((r, idx) => {
            table.innerHTML += `<tr><td>${idx+1}</td><td>${r.name}</td><td>${r.instructions}</td></tr>`;
        });
    }

    // Add Ingredient
    document.getElementById("ingredientForm").addEventListener("submit", async e => {
        e.preventDefault();
        const name = document.getElementById("ingredientName").value;
        const quantity = document.getElementById("ingredientQty").value;
        await fetch(ING_URL, {
            method: "POST",
            headers: {"Content-Type": "application/json"},
            body: JSON.stringify({ name, quantity })
        });
        e.target.reset();
        loadIngredients();
    });

    // Add Recipe
    document.getElementById("recipeForm").addEventListener("submit", async e => {
        e.preventDefault();
        const name = document.getElementById("recipeName").value;
        const instructions = document.getElementById("recipeInstructions").value;
        await fetch(REC_URL, {
            method: "POST",
            headers: {"Content-Type": "application/json"},
            body: JSON.stringify({ name, instructions })
        });
        e.target.reset();
        loadRecipes();
    });

    // Load data initially
    loadIngredients();
    loadRecipes();
</script>

</body>
</html>
